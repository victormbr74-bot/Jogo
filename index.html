<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Fogo &amp; Seda - Tabuleiro</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body class="theme-ember">
    <div class="app">
      <header class="topbar">
        <div class="topbar-inner">
          <div class="brand">
            <div class="brand-mark">F&amp;S</div>
            <h1>Fogo &amp; Seda</h1>
          </div>
          <div class="topbar-actions">
            <button class="btn ghost icon" id="openSettings" aria-label="Abrir preferencias">
              Preferencias
            </button>
            <button class="btn ghost icon" id="resetTop" aria-label="Resetar jogo">
              Reset
            </button>
          </div>
        </div>
      </header>

      <main class="main">
        <section class="current-action-box" id="currentActionBox">
          <div class="current-action-head">
            <div>
              <div class="current-action-label">Desafio atual</div>
              <div class="current-action-title-line">
                <span class="current-action-badge" id="currentActionBadge">Aguardando</span>
                <span class="current-action-kind" id="currentActionKind">Ação</span>
              </div>
            </div>
            <button
              class="btn ghost compact"
              id="currentActionExpand"
              aria-label="Ver detalhes do desafio atual"
            >
              Expandir
            </button>
          </div>
          <p class="current-action-text" id="currentActionText">
            Nenhuma ação pendente. Role o dado para iniciar.
          </p>
          <div class="current-action-meta">
            <span class="current-action-meta-item" id="currentActionZone">Zona Leve</span>
            <span
              class="current-action-meta-item current-action-mandatory tag"
              id="currentActionMandatory"
              hidden
            >
              Obrigatória
            </span>
          </div>
          <div class="current-action-penalty" id="currentActionPenalty" hidden>
            Penalidade: -3 casas · 1 rodada · sem interação
          </div>
          <div class="current-action-actions">
            <button class="btn primary" id="actionExecute">
              Executar
            </button>
            <button class="btn ghost" id="actionRefuse">
              Recusar
            </button>
          </div>
        </section>

        <section class="controls">
          <div class="turn">
            <div class="turn-label">Jogador da vez</div>
            <div class="turn-name" id="currentPlayerName">Jogador 1</div>
            <div class="zone-badge" id="zoneBadge">Zona Leve</div>
            <div class="turn-status" id="turnStatus"></div>
          </div>
          <div class="controlsRow">
            <div class="dice-panel dicePanel">
              <button class="btn dice-btn" id="rollDice" aria-label="Rolar dado">
                Rolar dado
              </button>
              <div class="dice-value" id="diceValue">-</div>
            </div>
            <div class="decksPanel">
              <div class="decks-grid compact">
                <div class="deck compact">
                  <div class="deck-stack normal" id="normalDeck">
                    <div class="deck-card deck-card-bottom"></div>
                    <div class="deck-card deck-card-mid"></div>
                    <div class="deck-card deck-card-top"></div>
                    <div class="deck-count" id="normalDeckCount">0</div>
                  </div>
                  <div class="deck-title">
                    <span class="deck-icon" aria-hidden="true"></span>
                    Cartas Normais
                  </div>
                </div>
                <div class="deck compact">
                  <div class="deck-stack event6" id="event6Deck">
                    <div class="deck-card deck-card-bottom"></div>
                    <div class="deck-card deck-card-mid"></div>
                    <div class="deck-card deck-card-top"></div>
                    <div class="deck-count" id="event6DeckCount">0</div>
                  </div>
                  <div class="deck-title">
                    <span class="deck-icon" aria-hidden="true"></span>
                    Evento 6
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <section class="board-shell">
          <div class="board-wrap" id="boardWrap">
            <svg id="boardSvg" aria-label="Tabuleiro Fogo e Seda"></svg>
          </div>
          <button class="btn ghost board-fab" id="centerPlayer">Centralizar</button>
        </section>
      </main>

      <nav class="bottom-tabs" aria-label="Navegacao inferior">
        <button class="tab" data-sheet-target="decksSheet">Decks</button>
        <button class="tab" data-sheet-target="leaderboardSheet">Placar</button>
        <button class="tab" data-sheet-target="historySheet">Historico</button>
      </nav>
    </div>
    <div class="modal-backdrop" id="modalBackdrop" hidden></div>

    <div class="modal" id="settingsModal" aria-hidden="true" role="dialog" aria-label="Preferencias">
      <div class="modal-header">
        <h2>Preferencias</h2>
        <button class="btn ghost" data-close-modal>Fechar</button>
      </div>
      <div class="modal-body">
        <section class="modal-section">
          <h3>Jogadores</h3>
          <div class="players-list" id="playersList"></div>
          <div class="players-actions">
            <button class="btn ghost" id="addPlayer">Adicionar jogador</button>
            <button class="btn ghost" id="removePlayer">Remover jogador</button>
          </div>
        </section>
        <section class="modal-section">
          <h3>Filtros</h3>
          <div class="toggle-list">
            <label class="toggle"><input type="checkbox" id="noNudez" />Sem nudez</label>
            <label class="toggle"><input type="checkbox" id="noDom" />Sem dominacao</label>
            <label class="toggle"><input type="checkbox" id="noOral" />Sem oral</label>
          </div>
        </section>
        <section class="modal-section">
          <h3>Meu Baralho</h3>
          <button class="btn" id="openDeckEditor">Abrir editor</button>
        </section>
        <section class="modal-section">
          <h3>Partida</h3>
          <button class="btn ghost danger" id="resetGame">Resetar jogo</button>
        </section>
      </div>
    </div>

    <div class="modal" id="resetModal" aria-hidden="true" role="dialog" aria-label="Confirmar reset">
      <div class="modal-header">
        <h2>Resetar jogo</h2>
        <button class="btn ghost" data-close-modal>Fechar</button>
      </div>
      <div class="modal-body">
        <p>
          Tem certeza? Isso reinicia a partida, zera posicoes, pontuacoes, bloqueios, carta
          atual e historico da partida.
        </p>
        <label class="toggle">
          <input type="checkbox" id="resetTotal" />
          Reset total (limpa filtros e nomes)
        </label>
        <div class="form-actions">
          <button class="btn ghost" id="resetCancel">Cancelar</button>
          <button class="btn danger" id="resetConfirm">Confirmar reset</button>
        </div>
      </div>
    </div>

    <div class="sheet-backdrop" id="sheetBackdrop" hidden></div>

    <div class="sheet" id="actionSheet" role="dialog" aria-label="Acao atual" aria-hidden="true">
      <div class="sheet-header">
        <div class="sheet-title">Acao atual</div>
        <button class="btn ghost compact" data-sheet-close>Fechar</button>
      </div>
      <section class="action-card actionCard--expanded" id="actionCard">
        <div class="action-header">
          <div class="action-icon" id="actionIcon">ƒoù</div>
          <div>
            <div class="action-type" id="actionType">Pronto para jogar</div>
            <div class="action-meta" id="actionMeta">Rolar o dado para comecar</div>
          </div>
        </div>
        <div class="action-body">
          <p class="action-text" id="actionText">
            As instrucoes aparecem aqui. Linguagem direta, curta e objetiva.
          </p>
          <div class="action-tags">
            <span class="tag" id="actionMandatory" hidden>Obrigatoria</span>
            <span class="tag warning" id="actionPenalty"
              >Penalidade: -3 casas + 1 rodada + sem interacao</span
            >
          </div>
        </div>
        <div class="action-actions">
          <button class="btn primary" id="actionExecute">Executar</button>
          <button class="btn ghost" id="actionRefuse">Recusar</button>
        </div>
        <div class="action-warning" id="actionWarning" hidden>
          Sem opcoes com filtros atuais. Reduza filtros.
          <button class="btn ghost" id="relaxFilters">Reduzir filtros</button>
        </div>
      </section>
    </div>

    <div class="sheet" id="decksSheet" role="dialog" aria-label="Decks" aria-hidden="true">
      <div class="sheet-header">
        <div class="sheet-title">Decks</div>
        <button class="btn ghost compact" data-sheet-close>Fechar</button>
      </div>
      <section class="panel-block">
        <div class="panel-header">
          <h2>Decks</h2>
        </div>
        <p class="panel-note">
          A caixa acima é a única referência do desafio atual. Role o dado ou expanda para ver mais
          detalhes.
        </p>
      </section>
    </div>

    <div class="sheet" id="leaderboardSheet" role="dialog" aria-label="Placar" aria-hidden="true">
      <div class="sheet-header">
        <div class="sheet-title">Placar</div>
        <button class="btn ghost compact" data-sheet-close>Fechar</button>
      </div>
      <section class="panel-block">
        <div class="leaderboard-list" id="leaderboardList"></div>
      </section>
    </div>

    <div class="sheet" id="historySheet" role="dialog" aria-label="Historico" aria-hidden="true">
      <div class="sheet-header">
        <div class="sheet-title">Historico</div>
        <button class="btn ghost compact" data-sheet-close>Fechar</button>
      </div>
      <section class="panel-block">
        <div class="panel-header">
          <h2>Historico recente</h2>
          <button class="btn ghost compact" id="exportPdf">Exportar PDF</button>
        </div>
        <div class="history-list" id="historyList"></div>
      </section>
    </div>

    <div class="modal" id="deckModal" aria-hidden="true" role="dialog" aria-label="Editor do baralho">
      <div class="modal-header">
        <h2>Meu Baralho</h2>
        <button class="btn ghost" data-close-modal>Fechar</button>
      </div>
      <div class="modal-body">
        <div class="tab-bar">
          <button class="tab active" data-tab="actions">Acoes</button>
          <button class="tab" data-tab="normal">Cartas normais</button>
          <button class="tab" data-tab="event6">Cartas evento 6</button>
        </div>
        <div class="tab-panel active" data-panel="actions">
          <div class="editor-actions">
            <button class="btn ghost" id="addAction">Adicionar acao</button>
          </div>
          <div class="editor-list" id="actionsList"></div>
        </div>
        <div class="tab-panel" data-panel="normal">
          <div class="editor-actions">
            <button class="btn ghost" id="addNormalCard">Adicionar carta normal</button>
          </div>
          <div class="editor-list" id="normalCardsList"></div>
        </div>
        <div class="tab-panel" data-panel="event6">
          <div class="editor-actions">
            <button class="btn ghost" id="addEvent6Card">Adicionar carta evento 6</button>
          </div>
          <div class="editor-list" id="event6CardsList"></div>
        </div>
        <div class="import-export">
          <button class="btn ghost" id="exportDeck">Exportar JSON</button>
          <label class="btn ghost">
            Importar JSON
            <input id="importDeck" type="file" accept="application/json" hidden />
          </label>
        </div>
      </div>
    </div>

    <div class="modal" id="cardsModal" aria-hidden="true" role="dialog" aria-label="Escolher carta">
      <div class="modal-header">
        <h2>Escolha 1 carta</h2>
        <button class="btn ghost" data-close-modal>Fechar</button>
      </div>
      <div class="modal-body">
        <div class="cards-grid" id="cardsGrid"></div>
      </div>
    </div>

    <div class="modal" id="editModal" aria-hidden="true" role="dialog" aria-label="Editar item">
      <div class="modal-header">
        <h2 id="editTitle">Editar</h2>
        <button class="btn ghost" data-close-modal>Fechar</button>
      </div>
      <div class="modal-body">
        <form id="editForm" class="edit-form">
          <input type="hidden" id="editId" />
          <input type="hidden" id="editKind" />
          <label>
            Texto
            <textarea id="editText" required></textarea>
          </label>
          <label class="form-row">
            Zona
            <select id="editZone">
              <option value="leve">Leve</option>
              <option value="quente">Quente</option>
              <option value="final">Final</option>
            </select>
          </label>
          <label class="form-row" id="editCategoryRow">
            Categoria
            <select id="editCategory">
              <option value="verdade">Verdade</option>
              <option value="desafio">Desafio</option>
              <option value="acao_visual">Acao visual</option>
            </select>
          </label>
          <label class="form-row" id="editIconRow">
            Icone (emoji)
            <input id="editIcon" type="text" maxlength="2" />
          </label>
          <label class="form-row" id="editMandatoryRow">
            Obrigatoria
            <input id="editMandatory" type="checkbox" />
          </label>
          <fieldset>
            <legend>Filtros</legend>
            <label class="toggle"><input type="checkbox" id="banNudez" />Nudez</label>
            <label class="toggle"><input type="checkbox" id="banDom" />Dominacao</label>
            <label class="toggle"><input type="checkbox" id="banOral" />Oral</label>
          </fieldset>
          <div class="form-actions">
            <button class="btn primary" type="submit">Salvar</button>
          </div>
        </form>
      </div>
    </div>

    <script type="module" src="ui/app.js"></script>
  </body>
</html>
